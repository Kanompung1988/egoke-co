# ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏´‡∏ß‡∏ï - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!

## üéØ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß

### 1. ‚úÖ Firestore Rules (Deploy ‡πÅ‡∏•‡πâ‡∏ß)
- **Users Collection**: ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ user ‡πÅ‡∏Å‡πâ voteRights ‡πÅ‡∏•‡∏∞ voteHistory ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ
- **Candidates Collection**: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å isStaff() ‡πÄ‡∏õ‡πá‡∏ô isAdmin() 
- **VoteSettings Collection**: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å isStaff() ‡πÄ‡∏õ‡πá‡∏ô isAdmin()

### 2. ‚úÖ Database - ‡πÄ‡∏û‡∏¥‡πà‡∏° voteRights ‡πÉ‡∏´‡πâ user ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
```bash
# ‡∏£‡∏±‡∏ô fix-vote-permissions.cjs ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢
üìà Updated: 93 users
‚è≠Ô∏è  Skipped: 1 user (SuperAdmin)
```

**‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö:**
- `voteRights`: { band: 1, solo: 1, cover: 1 }
- `voteHistory`: { band: [], solo: [], cover: [] }
- `points`: 100 (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)

### 3. ‚ö†Ô∏è firebaseApp.ts - ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πâ

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤**: User ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà login ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏à‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ voteRights

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ (‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠)**:

‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå `src/firebaseApp.ts` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 117-143 ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏Å‡πâ‡πÄ‡∏õ‡πá‡∏ô:

```typescript
if (!snapshot.exists()) {
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á user ‡πÉ‡∏´‡∏°‡πà
    const newUser = {
        uid: user.uid,
        displayName: user.displayName ?? "Anonymous",
        email: user.email ?? "",
        photoURL: user.photoURL ?? "",
        points: role === "superadmin" ? 999999999 : 100,  // ‚Üê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 0 ‡πÄ‡∏õ‡πá‡∏ô 100
        tickets: role === "superadmin" ? 999999 : 0,
        role: role,
        voteRights: {              // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
            band: 1,               // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
            solo: 1,               // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
            cover: 1               // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
        },                         // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
        voteHistory: {             // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
            band: [],              // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
            solo: [],              // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
            cover: []              // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
        },                         // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
        createdAt: new Date(),
    };
    await setDoc(userRef, newUser);
    console.log(`‚ú® New user created with role: ${role}`);
} else {
    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô superadmin ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó role ‡πÄ‡∏™‡∏°‡∏≠
    if (user.email === SUPER_ADMIN_EMAIL) {
        await updateDoc(userRef, {
            role: "superadmin",
            points: 999999999,
            tickets: 999999,
        });
        console.log("üëë SuperAdmin updated");
    }
    
    // ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ
    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ user ‡πÄ‡∏Å‡πà‡∏≤‡∏°‡∏µ voteRights ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
    const userData = snapshot.data();
    if (!userData.voteRights) {
        await updateDoc(userRef, {
            voteRights: {
                band: 1,
                solo: 1,
                cover: 1
            },
            voteHistory: {
                band: [],
                solo: [],
                cover: []
            }
        });
        console.log('üîÑ Added voteRights to existing user');
    }
    // ‚Üê ‡∏à‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°
    
    console.log('üë§ Existing user logged in');
}
```

## üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ

### 1. ‡πÅ‡∏Å‡πâ firebaseApp.ts ‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠
‡∏ï‡∏≤‡∏° code ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô

### 2. Build
```bash
npm run build
```

### 3. Commit & Push
```bash
git add .
git commit -m "Add voteRights to all users - enable voting system"
git push origin main
```

### 4. Deploy to Vercel
```bash
npx vercel --prod
```

## ‚úÖ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á Deploy

**User ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô (‡∏£‡∏ß‡∏° user ‡πÉ‡∏´‡∏°‡πà) ‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:**
- ‚úÖ ‡πÇ‡∏´‡∏ß‡∏ï‡∏ü‡∏£‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î (band, solo, cover)
- ‚úÖ ‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÇ‡∏´‡∏ß‡∏ï‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢ points (10 points = 1 ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå)
- ‚úÖ ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏ß‡∏ï‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
- ‚úÖ ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ "Missing or insufficient permissions" ‡∏≠‡∏µ‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ!

**Admin ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:**
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÑ‡∏î‡πâ (‡πÅ‡∏Å‡πâ isStaff ‚Üí isAdmin ‡πÅ‡∏•‡πâ‡∏ß)
- ‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏ß‡∏ï‡πÑ‡∏î‡πâ
- ‚úÖ ‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏ß‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

## üé® UI Modal ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏•‡πâ‡∏ß

**Modal "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£":**
- ‚úÖ ‡∏™‡∏µ‡πÅ‡∏î‡∏á-‡∏ó‡∏≠‡∏á (‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏ò‡∏µ‡∏°‡πÄ‡∏ß‡πá‡∏ö)
- ‚úÖ ‡πÅ‡∏Å‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ç‡∏ì‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î (disable ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á)
- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á loading spinner + "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å..."
- ‚úÖ Responsive (bottom sheet ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)
- ‚úÖ ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô emoji ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ü‡∏¥‡∏•‡∏î‡πå

## üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥

- üë• Users ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: 94 ‡∏Ñ‡∏ô
- ‚úÖ Updated: 93 ‡∏Ñ‡∏ô
- ‚è≠Ô∏è Skipped: 1 ‡∏Ñ‡∏ô (SuperAdmin - ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)

---

**‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠**: 27 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2026
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞**: ‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏° deploy (‡∏£‡∏≠‡πÅ‡∏Å‡πâ firebaseApp.ts)
